{% extends "layout.html" %}

{% block title %}
    Tasks
{% endblock %}

{% block main %}
    <div class = "mb-3">
        <h1>Tasks</h1>
    </div>
    <form action = "/" method = "POST">
        <div class = "mb-3">
            {% if tasks %}
                {% set has_incomplete_tasks = false %}
                {% for task in tasks %}
                    {% if task.status != "COMPLETED" %}
                        {% set has_incomplete_tasks = true %}
                    {% endif %}
                {% endfor %}
                {% if has_incomplete_tasks %}
                    <table class = "table table-stripped" style = "width: 50vw; margin: 0 auto;">
                        <thead>
                            <th scope = "col"></th>
                            <th scope = "col">Title</th>
                            <th scope = "col">Created on</th>
                            <th scope = "col">Start date</th>
                            <th scope = "col">End date</th>
                            <th scope = "col">Description</th>
                            <th scope = "col">Status</th>
                        </thead>
                        <tbody>
                            {% for task in tasks %}
                                <tr>
                                    <td><input class = "form-check-input" id = "{{ task.title }}" type = "checkbox" name = "checked" value = "{{ task.id }}"></td>
                                    <td>{{ task["title"] }}</td>
                                    <td>{{ task["dateCreation"] }}</td>
                                    <td>{{ task["dateStart"] }}</td>
                                    <td>{{ task["dateEnd"] }}</td>
                                    <td>{{ task["description"] }}</td>
                                    <td>{{ task["status"] }}</td>
                                </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                {% else %}
                    <table class = "table table-stripped" style = "width: 50vw; margin: 0 auto;">
                        <thead>
                            <th scope = "col"></th>
                            <th scope = "col">Title</th>
                            <th scope = "col">Created on</th>
                            <th scope = "col">Start date</th>
                            <th scope = "col">End date</th>
                            <th scope = "col">Description</th>
                            <th scope = "col">Status</th>
                        </thead>
                        <tbody>
                            <tr>
                                <td><input class = "form-check-input" disabled id = "flexCheckDisabled" type = "checkbox" name = "checked" value = "None"></td>
                                <td>--</td>
                                <td>--</td>
                                <td>--</td>
                                <td>--</td>
                                <td>--</td>
                                <td>--</td>
                            </tr>
                        </tbody>
                    </table>
                {% endif %}
            {% else %}
                <table class = "table table-stripped" style = "width: 50vw; margin: 0 auto;">
                    <thead>
                        <th scope = "col"></th>
                        <th scope = "col">Title</th>
                        <th scope = "col">Created on</th>
                        <th scope = "col">Start date</th>
                        <th scope = "col">End date</th>
                        <th scope = "col">Description</th>
                        <th scope = "col">Status</th>
                    </thead>
                    <tbody>
                        <tr>
                            <td><input class = "form-check-input" disabled id = "flexCheckDisabled" type = "checkbox" name = "checked" value = "None"></td>
                            <td>--</td>
                            <td>--</td>
                            <td>--</td>
                            <td>--</td>
                            <td>--</td>
                            <td>--</td>
                        </tr>
                    </tbody>
                </table>
            {% endif %} 
        </div>
        <div class = "mb-3">
            <div class = "container" style = "width: 50vw; margin: 0 auto;">
                <div class = "row">
                    <div class = "col-sm">
                        <button class = "btn btn-primary" href = "/addTask" style = "white-space: nowrap;" name = "addBtn"><i class = "fa-solid fa-plus"></i>    Add task</button>
                    </div>
                    <div class = "col-sm">
                        <button class = "btn btn-primary" href = "/editTask" style = "white-space: nowrap;" name = "editBtn"><i class = "fa-regular fa-pen-to-square"></i>    Edit task</button>
                    </div>
                    <div class = "col-sm">
                        <button class = "btn btn-primary" type = "submit" style = "white-space: nowrap;" name = "deleteBtn"><i class = "fa-regular fa-trash-can"></i>     Delete task</button>
                    </div>
                    <div class = "col-sm">
                        <button class = "btn btn-primary" type = "submit" style = "white-space: nowrap;" name = "completeBtn"><i class="fa-regular fa-square-check"></i>     Complete task</button>
                    </div>
                </div>
            </div>
        </div>
    </form>
{% endblock %}